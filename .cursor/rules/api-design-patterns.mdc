---
description:
globs:
alwaysApply: false
---
# API ë””ìì¸ íŒ¨í„´

## ğŸ›ï¸ Clean Architecture êµ¬í˜„

### ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
backend/src/
â”œâ”€â”€ entities/          # ë„ë©”ì¸ ì—”í‹°í‹° (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í•µì‹¬)
â”œâ”€â”€ repositories/      # ë°ì´í„° ì•¡ì„¸ìŠ¤ ì¸í„°í˜ì´ìŠ¤
â”œâ”€â”€ usecases/         # ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™
â”œâ”€â”€ controllers/      # API ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
â”œâ”€â”€ routes/          # API ë¼ìš°íŠ¸ ì •ì˜
â”œâ”€â”€ prompts/         # GPT í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
â”œâ”€â”€ config/          # ì„¤ì • íŒŒì¼
â””â”€â”€ types/           # TypeScript íƒ€ì… ì •ì˜
```

### ì£¼ìš” íŒŒì¼ë“¤
- **ë¼ìš°íŠ¸ ì •ì˜**: [backend/src/routes/index.ts](mdc:backend/src/routes/index.ts)
- **íƒ€ì… ì •ì˜**: [backend/src/types/common.ts](mdc:backend/src/types/common.ts)
- **í™˜ê²½ ì„¤ì •**: [backend/src/config/env.ts](mdc:backend/src/config/env.ts)

## ğŸ¯ API ì—”ë“œí¬ì¸íŠ¸ íŒ¨í„´

### ì¶”ì²œ API íŒ¨í„´
```typescript
// ë¬´ë£Œ ì¶”ì²œ: GPT-3.5-turbo ì‚¬ìš©
POST /api/recommend/free
{
  "gameCount": 5,
  "round": 1105,
  "conditions": {
    "excludeNumbers": [1, 2, 3],
    "includeNumbers": [7, 14],
    "preferences": "í™€ìˆ˜ ë²ˆí˜¸ë¥¼ ì„ í˜¸í•©ë‹ˆë‹¤"
  }
}

// í”„ë¦¬ë¯¸ì—„ ì¶”ì²œ: GPT-4o ì‚¬ìš© (ì´ë¯¸ì§€ ì§€ì›)
POST /api/recommend/premium
Content-Type: multipart/form-data
{
  "image": File,
  "data": JSON.stringify({
    "gameCount": 10,
    "round": 1105
  })
}
```

### ì´ë¯¸ì§€ ì²˜ë¦¬ API íŒ¨í„´
```typescript
// ì´ë¯¸ì§€ ë²ˆí˜¸ ì¶”ì¶œ: GPT-4o Vision ì‚¬ìš©
POST /api/image/extract
Content-Type: multipart/form-data
{
  "image": File
}
```

### íšŒê³  ë¶„ì„ API íŒ¨í„´
```typescript
// ì¶”ì²œ ê²°ê³¼ íšŒê³  ìƒì„±
POST /api/review/generate
{
  "recommendationId": "uuid",
  "winningNumbers": [1, 7, 14, 21, 28, 35],
  "round": 1105
}
```

## ğŸ”’ ë³´ì•ˆ ë° ì œí•œ

### Rate Limiting
- **ë¬´ë£Œ ì¶”ì²œ**: IPë³„ í•˜ë£¨ 1íšŒ
- **í”„ë¦¬ë¯¸ì—„ ì¶”ì²œ**: ì‹œê°„ë‹¹ 10íšŒ
- **ì´ë¯¸ì§€ ë¶„ì„**: ì‹œê°„ë‹¹ 5íšŒ
- **íšŒê³  ìƒì„±**: ì‹œê°„ë‹¹ 3íšŒ

### ë¯¸ë“¤ì›¨ì–´ ì²´ì¸
```typescript
router.post('/free',
  freeRecommendationLimiter,        // Rate limiting
  freeRecommendationIPLimit,        // IP ì œí•œ
  validateFreeRecommendationRequest, // ìš”ì²­ ê²€ì¦
  controller.generateFreeRecommendation // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
);
```

## ğŸ“Š ì‘ë‹µ ë°ì´í„° êµ¬ì¡°

### ì„±ê³µ ì‘ë‹µ
```typescript
{
  "success": true,
  "data": {
    "gameCount": 5,
    "numbers": [[1,7,14,21,28,35], [2,8,15,22,29,36]],
    "round": 1105,
    "analysis": "ì¶”ì²œ ë¶„ì„ ë‚´ìš©"
  },
  "message": "ì¶”ì²œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",
  "timestamp": "2025-06-23T12:00:00.000Z"
}
```

### ì—ëŸ¬ ì‘ë‹µ
```typescript
{
  "success": false,
  "error": "ì—ëŸ¬ ë©”ì‹œì§€",
  "message": "ìƒì„¸ ì„¤ëª…",
  "data": {
    "code": "ERROR_CODE",
    "details": {}
  },
  "timestamp": "2025-06-23T12:00:00.000Z"
}
```

## ğŸ¤– AI í†µí•© íŒ¨í„´

### GPT í”„ë¡¬í”„íŠ¸ ê´€ë¦¬
- **í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿**: [backend/src/prompts/](mdc:backend/src/prompts/) ë””ë ‰í† ë¦¬
- **ë™ì  í”„ë¡¬í”„íŠ¸**: ì‚¬ìš©ì ì¡°ê±´ì— ë”°ë¥¸ í”„ë¡¬í”„íŠ¸ ìƒì„±
- **ì‘ë‹µ íŒŒì‹±**: êµ¬ì¡°í™”ëœ JSON ì‘ë‹µ íŒŒì‹±

### ëª¨ë¸ë³„ ì‚¬ìš©
- **GPT-3.5-turbo**: ë¬´ë£Œ ì¶”ì²œ (ë¹ ë¥¸ ì‘ë‹µ, ë¹„ìš© íš¨ìœ¨)
- **GPT-4o**: í”„ë¦¬ë¯¸ì—„ ì¶”ì²œ (ê³ í’ˆì§ˆ ë¶„ì„)
- **GPT-4o Vision**: ì´ë¯¸ì§€ ë²ˆí˜¸ ì¶”ì¶œ (OCR ê¸°ëŠ¥)
