---
description:
globs:
alwaysApply: false
---
# ë°±ì—”ë“œ ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë° ì‹¤ìˆ˜ ë°©ì§€ ê°€ì´ë“œ

## ğŸš¨ ì¤‘ìš”: ë°±ì—”ë“œ ìˆ˜ì • í›„ í•„ìˆ˜ ë‹¨ê³„ë“¤

### 1. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì‹œ

#### âœ… Prisma ìŠ¤í‚¤ë§ˆ ìˆ˜ì • í›„ ë°˜ë“œì‹œ ì‹¤í–‰í•  ëª…ë ¹ì–´ë“¤
```bash
# 1. Prisma í´ë¼ì´ì–¸íŠ¸ ì¬ìƒì„±
npx prisma generate

# 2. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë™ê¸°í™” (ê°œë°œí™˜ê²½)
npx prisma db push

# ë˜ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„± (í”„ë¡œë•ì…˜ ì¤€ë¹„)
npx prisma migrate dev --name [ë³€ê²½ì‚¬í•­_ì„¤ëª…]
```

#### ğŸ”¥ í”í•œ ì‹¤ìˆ˜ë“¤
- `Property 'newModel' does not exist on type 'PrismaClient'` 
  â†’ **í•´ê²°**: `npx prisma generate` ì‹¤í–‰ ëˆ„ë½
- JSON í•„ë“œì—ì„œ `Type 'null' is not assignable to type 'InputJsonValue'`
  â†’ **í•´ê²°**: `null` ëŒ€ì‹  `undefined` ì‚¬ìš©

### 2. ìƒˆë¡œìš´ ì—”í‹°í‹°/ë¦¬í¬ì§€í† ë¦¬ ì¶”ê°€ ì‹œ

#### âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ì—”í‹°í‹° í´ë˜ìŠ¤ ìƒì„± ([entities/](mdc:backend/src/entities/))
- [ ] ì¸í„°í˜ì´ìŠ¤ ì •ì˜ ([repositories/](mdc:backend/src/repositories/))
- [ ] Prisma êµ¬í˜„ì²´ ìƒì„± ([repositories/impl/](mdc:backend/src/repositories/impl/))
- [ ] UseCaseì—ì„œ í™œìš©
- [ ] Controllerì— ì£¼ì…
- [ ] **DI ì»¨í…Œì´ë„ˆì— ë“±ë¡** ([routes/index.ts](mdc:backend/src/routes/index.ts))

#### ğŸ”¥ í”í•œ ì‹¤ìˆ˜
- DI ì»¨í…Œì´ë„ˆ í”„ë¡œí¼í‹° ì„ ì–¸ ëˆ„ë½
- Constructor ë§¤ê°œë³€ìˆ˜ ìˆœì„œ ë¶ˆì¼ì¹˜
- íƒ€ì… ì„ ì–¸ vs ì‹¤ì œ êµ¬í˜„ ë¶ˆì¼ì¹˜

### 3. ìƒˆë¡œìš´ API ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€ ì‹œ

#### âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] Controller ë©”ì„œë“œ êµ¬í˜„
- [ ] Routes íŒŒì¼ì— ì—”ë“œí¬ì¸íŠ¸ ë“±ë¡
- [ ] **Swagger ë¬¸ì„œ ì‘ì„±** (JSDoc í˜•íƒœ)
- [ ] ë¯¸ë“¤ì›¨ì–´ ì ìš© (ì¸ì¦, ìœ íš¨ì„±ê²€ì‚¬, ë ˆì´íŠ¸ë¦¬ë°‹)
- [ ] TypeScript ë¹Œë“œ í™•ì¸
- [ ] Docker ì¬ë¹Œë“œ

#### ğŸ”¥ í”í•œ ì‹¤ìˆ˜ë“¤
- Swagger ë¬¸ì„œ ëˆ„ë½ìœ¼ë¡œ API ë¬¸ì„œì— ë°˜ì˜ ì•ˆë¨
- ë¹Œë“œ ì˜¤ë¥˜ë¡œ ìƒˆ ì—”ë“œí¬ì¸íŠ¸ê°€ ì‹¤ì œë¡œ ë“±ë¡ë˜ì§€ ì•ŠìŒ

### 4. TypeScript ë¹Œë“œ ë° ë°°í¬

#### âœ… ë°˜ë“œì‹œ í™•ì¸í•  ë‹¨ê³„ë“¤
```bash
# 1. ë¡œì»¬ ë¹Œë“œ í…ŒìŠ¤íŠ¸
cd backend && npm run build

# 2. ë¹Œë“œ ì„±ê³µ í™•ì¸ í›„ Docker ì¬ë¹Œë“œ
cd .. && docker-compose down && docker-compose up -d --build

# 3. ì„œë²„ ë¡œê·¸ í™•ì¸
docker logs api-backend --tail=20

# 4. Swagger ë¬¸ì„œ ì—…ë°ì´íŠ¸ í™•ì¸
curl -s http://localhost:3350/openapi.json | jq '.paths | keys'
```

#### ğŸ”¥ í”í•œ ì‹¤ìˆ˜ë“¤
- TypeScript ë¹Œë“œ ì˜¤ë¥˜ ë¬´ì‹œí•˜ê³  Docker ì‹¤í–‰
- ìºì‹œëœ ì´ë¯¸ì§€ë¡œ ì¸í•œ ë³€ê²½ì‚¬í•­ ë¯¸ë°˜ì˜
- Swagger JSON ê°±ì‹  í™•ì¸ ëˆ„ë½

### 5. DI (Dependency Injection) íŒ¨í„´ ê´€ë¦¬

#### âœ… [routes/index.ts](mdc:backend/src/routes/index.ts) ìˆ˜ì • ì‹œ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] í´ë˜ìŠ¤ í”„ë¡œí¼í‹° ì„ ì–¸ (private readonly)
- [ ] `initializeDependencies()` ë©”ì„œë“œì—ì„œ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
- [ ] Controller ìƒì„±ìì— ì˜ì¡´ì„± ì£¼ì…
- [ ] ì˜ì¡´ì„± ìˆœì„œ í™•ì¸ (í•˜ìœ„ â†’ ìƒìœ„)

#### ğŸ”¥ í”í•œ ì‹¤ìˆ˜
```typescript
// âŒ ì˜ëª»ëœ ì˜ˆ: í”„ë¡œí¼í‹° ì„ ì–¸ ëˆ„ë½
this.newUseCase = new NewUseCase(); // Property 'newUseCase' does not exist

// âœ… ì˜¬ë°”ë¥¸ ì˜ˆ: í”„ë¡œí¼í‹° ë¨¼ì € ì„ ì–¸
private newUseCase!: NewUseCase;
// ê·¸ ë‹¤ìŒ initializeDependencies()ì—ì„œ ì´ˆê¸°í™”
this.newUseCase = new NewUseCase(dependencies...);
```

### 6. JSON í•„ë“œ ì²˜ë¦¬ (Prisma)

#### âœ… ì˜¬ë°”ë¥¸ íŒ¨í„´
```typescript
// âœ… JSON í•„ë“œ ì €ì¥ ì‹œ
conditions: params.conditions ? JSON.stringify(params.conditions) : undefined,

// âŒ ì˜ëª»ëœ íŒ¨í„´
conditions: params.conditions ? JSON.stringify(params.conditions) : null,
```

### 7. ì—”í‹°í‹° ìƒì„±ì ë§¤ê°œë³€ìˆ˜ ê´€ë¦¬

#### âœ… ì—”í‹°í‹° ìˆ˜ì • ì‹œ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ìƒì„±ì ë§¤ê°œë³€ìˆ˜ ìˆœì„œ í™•ì¸
- [ ] `create()` ì •ì  ë©”ì„œë“œ ë§¤ê°œë³€ìˆ˜ ì¼ì¹˜
- [ ] Repository `toDomain()` ë©”ì„œë“œ ë§¤ê°œë³€ìˆ˜ ì¼ì¹˜
- [ ] UseCaseì—ì„œ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„ ë§¤ê°œë³€ìˆ˜ ì¼ì¹˜

#### ğŸ”¥ í”í•œ ì‹¤ìˆ˜
```typescript
// âŒ ë§¤ê°œë³€ìˆ˜ ê°œìˆ˜ ë¶ˆì¼ì¹˜
return new RecommendationHistory(
  // 11ê°œ ë§¤ê°œë³€ìˆ˜ì¸ë° ìƒì„±ìëŠ” 12ê°œ ìš”êµ¬
);

// âœ… ìƒˆ í•„ë“œ ì¶”ê°€ ì‹œ ëª¨ë“  ê³³ì—ì„œ ì¼ì¹˜ì‹œí‚¤ê¸°
```

### 8. ë°±ì—”ë“œ ë³€ê²½ í›„ ìµœì¢… ê²€ì¦

#### âœ… í•„ìˆ˜ ê²€ì¦ ë‹¨ê³„
```bash
# 1. ë¹Œë“œ ì„±ê³µ í™•ì¸
npm run build

# 2. ì„œë²„ ì •ìƒ ì‹œì‘ í™•ì¸
docker logs api-backend | grep "ì„œë²„ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤"

# 3. ìƒˆ API ì—”ë“œí¬ì¸íŠ¸ ë“±ë¡ í™•ì¸
curl -s http://localhost:3350/openapi.json | jq '.paths | keys' | grep [ìƒˆë¡œìš´_ì—”ë“œí¬ì¸íŠ¸]

# 4. Swagger UIì—ì„œ ë¬¸ì„œ í™•ì¸
# http://localhost:3350/api-docs ì ‘ì†í•´ì„œ ìƒˆ API í™•ì¸
```

## ğŸ¯ í”„ë¡œì íŠ¸ë³„ íŠ¹ì´ì‚¬í•­

### ì´ í”„ë¡œì íŠ¸ì˜ í•µì‹¬ íŒŒì¼ë“¤
- [backend/src/routes/index.ts](mdc:backend/src/routes/index.ts) - DI ì»¨í…Œì´ë„ˆ ë° ë¼ìš°íŠ¸ ë“±ë¡
- [backend/prisma/schema.prisma](mdc:backend/prisma/schema.prisma) - ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
- [docker-compose.yml](mdc:docker-compose.yml) - ê°œë°œí™˜ê²½ ì„¤ì •

### ìì£¼ ìˆ˜ì •ë˜ëŠ” íŒ¨í„´
1. **ìƒˆ ì¶”ì²œ ê¸°ëŠ¥ ì¶”ê°€**: Entity â†’ Repository â†’ UseCase â†’ Controller â†’ Routes â†’ Swagger
2. **ê²°ì œ í”Œë¡œìš° ìˆ˜ì •**: PaymentUseCase â†’ PaymentController â†’ ìŠ¤í‚¤ë§ˆ ë³€ê²½ â†’ ë§ˆì´ê·¸ë ˆì´ì…˜
3. **ì¸ì¦/ê¶Œí•œ ë³€ê²½**: AuthController â†’ ë¯¸ë“¤ì›¨ì–´ â†’ ë¼ìš°íŠ¸ ì„¤ì •

## ğŸš€ ë¹ ë¥¸ ì²´í¬ ëª…ë ¹ì–´ ëª¨ìŒ

```bash
# ì „ì²´ ì²´í¬ ìŠ¤í¬ë¦½íŠ¸
cd backend
npm run build && \
cd .. && \
docker-compose down && \
docker-compose up -d --build && \
sleep 10 && \
docker logs api-backend --tail=10 && \
curl -s http://localhost:3350/openapi.json | jq '.paths | keys | length'
```

## âš ï¸ ì ˆëŒ€ í•˜ì§€ ë§ ê²ƒ

1. **ë¹Œë“œ ì˜¤ë¥˜ ë¬´ì‹œí•˜ê³  Docker ì‹¤í–‰í•˜ì§€ ë§ˆë¼**
2. **Prisma generate ì—†ì´ ìŠ¤í‚¤ë§ˆ ë³€ê²½í•˜ì§€ ë§ˆë¼**  
3. **DI ì»¨í…Œì´ë„ˆ ìˆ˜ì • í›„ í”„ë¡œí¼í‹° ì„ ì–¸ ë¹¼ë¨¹ì§€ ë§ˆë¼**
4. **Swagger ë¬¸ì„œ ì—†ì´ API ì¶”ê°€í•˜ì§€ ë§ˆë¼**
5. **Docker ìºì‹œ ë•Œë¬¸ì— ë³€ê²½ì‚¬í•­ ì•ˆ ë³´ì¸ë‹¤ê³  í¬ê¸°í•˜ì§€ ë§ˆë¼** â†’ `--build` í”Œë˜ê·¸ ì‚¬ìš©

---

**ğŸ¯ í•µì‹¬ ì›ì¹™: ë°±ì—”ë“œ ì½”ë“œ ìˆ˜ì • â†’ ë¹Œë“œ í…ŒìŠ¤íŠ¸ â†’ Docker ì¬ë¹Œë“œ â†’ ê²€ì¦ â†’ ë¬¸ì„œ í™•ì¸**
