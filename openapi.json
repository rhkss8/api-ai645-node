{"openapi":"3.0.0","info":{"title":"포포춘(For Fortune) 운세 API","version":"2.0.0","description":"AI 기반 운세 상담 플랫폼 - 사주, 타로, 꿈해몽, 행운번호 등"},"servers":[{"url":"http://localhost:3350","description":"Development server"}],"tags":[{"name":"Authentication","description":"소셜 로그인 및 인증 관련 API"},{"name":"Fortune","description":"운세 서비스 관련 API (채팅형/문서형)"},{"name":"Board","description":"게시판 관련 API"},{"name":"Admin","description":"관리자 관련 API"}],"components":{"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT","description":"JWT 액세스 토큰을 Bearer 형식으로 전달"}},"schemas":{"ErrorResponse":{"type":"object","properties":{"success":{"type":"boolean","example":false},"error":{"type":"string","example":"에러 메시지"},"message":{"type":"string","example":"상세 설명","nullable":true},"data":{"type":"object","nullable":true},"timestamp":{"type":"string","format":"date-time","example":"2025-06-23T12:00:00.000Z"}},"required":["success","error","timestamp"]},"LoginResponse":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"accessToken":{"type":"string","description":"JWT 액세스 토큰"},"user":{"type":"object","properties":{"id":{"type":"string"},"nickname":{"type":"string"}}},"expiresIn":{"type":"integer","description":"토큰 만료 시간 (초)"}}},"message":{"type":"string","example":"로그인이 완료되었습니다."}}}}},"paths":{"/api/admin/users":{"get":{"summary":"전체 사용자 목록 조회 (관리자 전용)","tags":["Admin"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"integer","default":1},"description":"페이지 번호"},{"in":"query","name":"limit","schema":{"type":"integer","default":20},"description":"페이지당 항목 수"}],"responses":{"200":{"description":"사용자 목록 조회 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"users":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"nickname":{"type":"string"},"role":{"type":"string","enum":["USER","ADMIN"]},"createdAt":{"type":"string","format":"date-time"},"authType":{"type":"string","enum":["KAKAO","GOOGLE","NAVER"]},"hasActiveSubscription":{"type":"boolean"},"subscriptionEndDate":{"type":"string","format":"date-time"},"recommendationCount":{"type":"integer"},"paymentCount":{"type":"integer"}}}},"pagination":{"type":"object","properties":{"page":{"type":"integer"},"limit":{"type":"integer"},"total":{"type":"integer"},"totalPages":{"type":"integer"},"hasNext":{"type":"boolean"},"hasPrev":{"type":"boolean"}}}}}}}}}},"401":{"description":"인증 실패"},"403":{"description":"관리자 권한 없음"}}}},"/api/admin/users/{userId}/role":{"put":{"summary":"사용자 역할 변경 (관리자 전용)","tags":["Admin"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"userId","required":true,"schema":{"type":"string"},"description":"사용자 ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["role"],"properties":{"role":{"type":"string","enum":["USER","ADMIN"],"description":"변경할 역할"}}}}}},"responses":{"200":{"description":"역할 변경 성공"},"400":{"description":"유효하지 않은 역할"},"401":{"description":"인증 실패"},"403":{"description":"관리자 권한 없음"},"404":{"description":"사용자를 찾을 수 없음"}}}},"/api/admin/stats/api":{"get":{"summary":"API 사용 통계 조회 (관리자 전용)","tags":["Admin"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"startDate","schema":{"type":"string","format":"date"},"description":"시작 날짜 (기본값: 30일 전)"},{"in":"query","name":"endDate","schema":{"type":"string","format":"date"},"description":"종료 날짜 (기본값: 오늘)"}],"responses":{"200":{"description":"API 통계 조회 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"period":{"type":"object","properties":{"startDate":{"type":"string","format":"date-time"},"endDate":{"type":"string","format":"date-time"}}},"overview":{"type":"object","properties":{"totalRequests":{"type":"integer"},"successCount":{"type":"integer"},"failureCount":{"type":"integer"},"successRate":{"type":"string"},"totalCost":{"type":"number"}}},"endpointStats":{"type":"array","items":{"type":"object","properties":{"endpoint":{"type":"string"},"requestCount":{"type":"integer"},"totalTokens":{"type":"integer"},"totalCost":{"type":"number"}}}},"modelStats":{"type":"array","items":{"type":"object","properties":{"model":{"type":"string"},"requestCount":{"type":"integer"},"totalTokens":{"type":"integer"},"totalCost":{"type":"number"}}}}}}}}}}},"401":{"description":"인증 실패"},"403":{"description":"관리자 권한 없음"}}}},"/api/admin/status":{"get":{"summary":"시스템 상태 조회 (관리자 전용)","tags":["Admin"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"시스템 상태 조회 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"users":{"type":"object","properties":{"total":{"type":"integer"},"activeSubscriptions":{"type":"integer"}}},"recommendations":{"type":"object","properties":{"total":{"type":"integer"},"today":{"type":"integer"}}},"payments":{"type":"object","properties":{"total":{"type":"integer"},"completed":{"type":"integer"},"completionRate":{"type":"string"}}},"system":{"type":"object","properties":{"databaseSize":{"type":"string"},"uptime":{"type":"number"},"memoryUsage":{"type":"object"}}}}}}}}}},"401":{"description":"인증 실패"},"403":{"description":"관리자 권한 없음"}}}},"/api/auth/profile":{"get":{"operationId":"getUserProfile","summary":"사용자 프로필 조회","description":"현재 로그인한 사용자의 정보를 조회합니다.","tags":["Authentication"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"프로필 조회 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"id":{"type":"string"},"nickname":{"type":"string"},"role":{"type":"string","enum":["USER","ADMIN"],"description":"사용자 역할"},"termsAgreed":{"type":"boolean","description":"이용약관 동의 여부"},"privacyAgreed":{"type":"boolean","description":"개인정보 수집·이용 동의 여부"},"marketingAgreed":{"type":"boolean","description":"마케팅 정보 수신 동의 여부"},"authType":{"type":"string","description":"주요 소셜 인증 타입"},"socialAccounts":{"type":"array","items":{"type":"object","properties":{"provider":{"type":"string"},"providerUid":{"type":"string"},"connectedAt":{"type":"string","format":"date-time"}}}},"createdAt":{"type":"string","format":"date-time"}}},"message":{"type":"string","example":"사용자 정보를 조회했습니다."}}}}}},"401":{"description":"인증 필요"},"404":{"description":"사용자를 찾을 수 없음"}}}},"/api/auth/refresh":{"post":{"operationId":"refreshToken","summary":"토큰 갱신","description":"리프레시 토큰을 사용하여 새로운 액세스 토큰을 발급합니다.","tags":["Authentication"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"토큰 갱신 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"accessToken":{"type":"string","description":"새로운 JWT 액세스 토큰"},"user":{"type":"object","properties":{"id":{"type":"string"},"nickname":{"type":"string"}}},"expiresIn":{"type":"integer","description":"토큰 만료 시간 (초)"}}},"message":{"type":"string","example":"토큰이 갱신되었습니다."}}}}}},"401":{"description":"토큰 갱신 실패","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":false},"errorCode":{"type":"string","enum":["MISSING_AUTHORIZATION_HEADER","EMPTY_ACCESS_TOKEN","TOKEN_EXPIRED","TOKEN_MALFORMED","TOKEN_SIGNATURE_INVALID","TOKEN_INVALID","USER_NOT_FOUND","REFRESH_TOKEN_ERROR"],"description":"에러 코드"},"error":{"type":"string","description":"에러 메시지"},"message":{"type":"string","example":"다시 로그인해주세요."}}}}}}}}},"/api/auth/logout":{"post":{"operationId":"logout","summary":"로그아웃","description":"현재 세션을 종료하고 토큰을 무효화합니다.","tags":["Authentication"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"로그아웃 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"로그아웃이 완료되었습니다."}}}}}},"401":{"description":"인증 필요"}}}},"/api/auth/temp-register":{"post":{"operationId":"createTempAccount","summary":"임시 계정 생성 (결제 심사용)","description":"결제 심사를 위한 임시 ID/비밀번호 계정을 생성합니다.","tags":["Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email","password","nickname"],"properties":{"email":{"type":"string","format":"email","example":"test@example.com","description":"로그인용 이메일"},"password":{"type":"string","minLength":6,"example":"password123","description":"로그인용 비밀번호"},"nickname":{"type":"string","minLength":2,"maxLength":40,"example":"테스터","description":"사용자 닉네임"}}}}}},"responses":{"201":{"description":"계정 생성 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"id":{"type":"string","example":"user_123"},"email":{"type":"string","example":"test@example.com"},"nickname":{"type":"string","example":"테스터"}}},"message":{"type":"string","example":"임시 계정이 생성되었습니다."}}}}}},"400":{"description":"필수 정보 누락"},"409":{"description":"이메일 중복"}}}},"/api/auth/temp-login":{"post":{"operationId":"loginWithPassword","summary":"ID/비밀번호 로그인 (결제 심사용)","description":"이메일과 비밀번호로 로그인합니다.","tags":["Authentication"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string","format":"email","example":"test@example.com","description":"로그인용 이메일"},"password":{"type":"string","example":"password123","description":"로그인용 비밀번호"}}}}}},"responses":{"200":{"description":"로그인 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"accessToken":{"type":"string","example":"eyJ0eXAiOiJKV1Q..."},"refreshToken":{"type":"string","example":"eyJ0eXAiOiJKV1Q..."},"user":{"type":"object","properties":{"id":{"type":"string","example":"user_123"},"email":{"type":"string","example":"test@example.com"},"nickname":{"type":"string","example":"테스터"},"role":{"type":"string","example":"USER"}}}}},"message":{"type":"string","example":"로그인에 성공했습니다."}}}}}},"400":{"description":"필수 정보 누락"},"401":{"description":"인증 실패"}}}},"/api/auth/account":{"delete":{"operationId":"deleteAccount","summary":"계정 탈퇴","description":"사용자 계정을 완전히 삭제합니다.","tags":["Authentication"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"계정 삭제 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"계정이 삭제되었습니다."}}}}}},"401":{"description":"인증 필요"},"500":{"description":"서버 오류"}}}},"/api/auth/consent":{"post":{"operationId":"updateConsent","summary":"동의항목 업데이트","description":"사용자의 동의항목을 업데이트합니다.","tags":["Authentication"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["termsAgreed","privacyAgreed"],"properties":{"termsAgreed":{"type":"boolean","description":"이용약관 동의 (필수)","example":true},"privacyAgreed":{"type":"boolean","description":"개인정보 수집·이용 동의 (필수)","example":true},"marketingAgreed":{"type":"boolean","description":"광고·이벤트 수신 동의 (선택)","example":false}}}}}},"responses":{"200":{"description":"동의항목 업데이트 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"user":{"type":"object","properties":{"id":{"type":"string"},"nickname":{"type":"string"},"role":{"type":"string","enum":["USER","ADMIN"]},"termsAgreed":{"type":"boolean"},"privacyAgreed":{"type":"boolean"},"marketingAgreed":{"type":"boolean"},"createdAt":{"type":"string","format":"date-time"}}}}},"message":{"type":"string","example":"동의항목이 업데이트되었습니다."}}}}}},"400":{"description":"필수 동의항목 누락","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":false},"error":{"type":"string","example":"필수 동의항목에 동의해야 합니다."},"message":{"type":"string","example":"이용약관과 개인정보 수집·이용에 동의해주세요."}}}}}},"401":{"description":"인증 필요"},"500":{"description":"서버 오류"}}}},"/api/auth/{provider}":{"get":{"operationId":"startSocialLogin","summary":"소셜 로그인 시작","description":"카카오, 구글, 네이버 소셜 로그인을 시작합니다.","tags":["Authentication"],"parameters":[{"in":"path","name":"provider","required":true,"schema":{"type":"string","enum":["kakao","google","naver"]},"description":"소셜 로그인 제공자"}],"responses":{"302":{"description":"소셜 로그인 페이지로 리다이렉트"}}}},"/api/auth/{provider}/callback":{"get":{"summary":"소셜 로그인 콜백","description":"소셜 로그인 완료 후 JWT 토큰을 발급합니다.","tags":["Authentication"],"parameters":[{"in":"path","name":"provider","required":true,"schema":{"type":"string","enum":["kakao","google","naver"]},"description":"소셜 로그인 제공자"}],"responses":{"200":{"description":"로그인 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"accessToken":{"type":"string","description":"JWT 액세스 토큰"},"user":{"type":"object","properties":{"id":{"type":"string"},"nickname":{"type":"string"}}},"expiresIn":{"type":"integer","description":"토큰 만료 시간 (초)"}}},"message":{"type":"string","example":"로그인이 완료되었습니다."}}}}}},"401":{"description":"로그인 실패"},"500":{"description":"서버 오류"}}}},"/api/board/{category}":{"get":{"operationId":"getBoardPosts","summary":"게시글 목록 조회","tags":["Board"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"category","required":true,"schema":{"type":"string","enum":["NOTICE","SUGGESTION","PARTNERSHIP"]},"description":"게시판 카테고리"},{"in":"query","name":"page","schema":{"type":"integer","default":1},"description":"페이지 번호"},{"in":"query","name":"limit","schema":{"type":"integer","default":20},"description":"페이지당 항목 수"}],"responses":{"200":{"description":"게시글 목록 조회 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"posts":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"category":{"type":"string"},"title":{"type":"string"},"authorName":{"type":"string"},"isImportant":{"type":"boolean"},"viewCount":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"}}}},"pagination":{"type":"object","properties":{"page":{"type":"integer"},"limit":{"type":"integer"},"total":{"type":"integer"},"totalPages":{"type":"integer"},"hasNext":{"type":"boolean"},"hasPrev":{"type":"boolean"}}}}}}}}}},"400":{"description":"유효하지 않은 카테고리"},"401":{"description":"인증 필요 (선택사항 - 토큰이 있으면 개인화된 데이터 제공)"}}},"post":{"operationId":"createBoardPost","summary":"게시글 생성","tags":["Board"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"category","required":true,"schema":{"type":"string","enum":["NOTICE","SUGGESTION","PARTNERSHIP"]},"description":"게시판 카테고리"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["title","content","authorName"],"properties":{"title":{"type":"string","maxLength":200,"description":"게시글 제목"},"content":{"type":"string","maxLength":10000,"description":"게시글 내용"},"authorName":{"type":"string","maxLength":40,"description":"작성자 이름 (모든 카테고리에서 필수)"},"isImportant":{"type":"boolean","default":false,"description":"중요공지 여부"}}}}}},"responses":{"201":{"description":"게시글 생성 성공"},"400":{"description":"유효하지 않은 입력"},"401":{"description":"인증 필요"}}}},"/api/board/post/{id}":{"get":{"operationId":"getBoardPost","summary":"게시글 조회 (단일)","tags":["Board"],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"게시글 ID"}],"responses":{"200":{"description":"게시글 조회 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"id":{"type":"string"},"category":{"type":"string"},"title":{"type":"string"},"content":{"type":"string"},"authorName":{"type":"string"},"authorId":{"type":"string"},"isImportant":{"type":"boolean"},"viewCount":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}}}}}},"404":{"description":"게시글을 찾을 수 없음"}}},"put":{"operationId":"updateBoardPost","summary":"게시글 수정","tags":["Board"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"게시글 ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"title":{"type":"string","maxLength":200,"description":"게시글 제목"},"content":{"type":"string","maxLength":10000,"description":"게시글 내용"},"isImportant":{"type":"boolean","description":"중요공지 여부"}}}}}},"responses":{"200":{"description":"게시글 수정 성공"},"400":{"description":"유효하지 않은 입력 또는 권한 없음"},"401":{"description":"인증 필요"},"404":{"description":"게시글을 찾을 수 없음"}}},"delete":{"operationId":"deleteBoardPost","summary":"게시글 삭제","tags":["Board"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"게시글 ID"}],"responses":{"200":{"description":"게시글 삭제 성공"},"400":{"description":"권한 없음"},"401":{"description":"인증 필요"},"404":{"description":"게시글을 찾을 수 없음"}}}},"/api/board/my":{"get":{"operationId":"getMyBoardPosts","summary":"내가 작성한 게시글 목록 조회","tags":["Board"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"query","name":"page","schema":{"type":"integer","default":1},"description":"페이지 번호"},{"in":"query","name":"limit","schema":{"type":"integer","default":20},"description":"페이지당 항목 수"}],"responses":{"200":{"description":"내 게시글 목록 조회 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"posts":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"category":{"type":"string"},"title":{"type":"string"},"content":{"type":"string"},"authorName":{"type":"string"},"authorId":{"type":"string"},"isImportant":{"type":"boolean"},"viewCount":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}},"pagination":{"type":"object","properties":{"page":{"type":"integer"},"limit":{"type":"integer"},"total":{"type":"integer"},"totalPages":{"type":"integer"},"hasNext":{"type":"boolean"},"hasPrev":{"type":"boolean"}}}}}}}}}},"401":{"description":"인증 필요"}}}},"/api/v1/fortune/session":{"post":{"operationId":"createFortuneSession","summary":"운세 세션 생성","description":"채팅형 또는 문서형 운세 세션을 생성합니다. 문서형은 결제 필수, 채팅형은 결제 또는 무료 홍시 선택 가능.","tags":["Fortune"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["category","formType","mode","userInput"],"properties":{"category":{"type":"string","enum":["SAJU","NEW_YEAR","MONEY","HAND","TOJEONG","BREAK_UP","CAR_PURCHASE","BUSINESS","INVESTMENT","LOVE","DREAM","LUCKY_NUMBER","MOVING","TRAVEL","COMPATIBILITY","TAROT","CAREER","LUCKY_DAY","NAMING","DAILY"],"description":"운세 카테고리","example":"SAJU"},"formType":{"type":"string","enum":["ASK","DAILY","TRADITIONAL"],"description":"폼 타입 (ASK=자유질문, DAILY=오늘의 운세, TRADITIONAL=전통 운세)","example":"ASK"},"mode":{"type":"string","enum":["CHAT","DOCUMENT"],"description":"세션 모드 (CHAT=채팅형, DOCUMENT=문서형)","example":"CHAT"},"userInput":{"type":"string","description":"사용자 질문 또는 정보","example":"1990년 1월 1일 오전 10시에 태어났어요"},"paymentId":{"type":"string","description":"결제 ID (문서형 필수, 채팅형 선택)","example":"clx1234567890"},"useFreeHongsi":{"type":"boolean","description":"무료 홍시 사용 여부 (채팅형만, 하루 1회, 2분 무료). paymentId와 동시 사용 불가","example":true},"durationMinutes":{"type":"number","enum":[5,10,30],"description":"채팅형 결제 시 시간 선택 (5, 10, 30분). paymentId 있을 때만 필수. useFreeHongsi 사용 시에는 무시됨 (자동으로 2분 고정)","example":10}}}}}},"responses":{"201":{"description":"세션 생성 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","properties":{"sessionId":{"type":"string"},"category":{"type":"string"},"formType":{"type":"string"},"mode":{"type":"string"},"remainingTime":{"type":"number","description":"남은 시간 (초)"},"isActive":{"type":"boolean"},"expiresAt":{"type":"string","format":"date-time"},"isPaid":{"type":"boolean"},"resultToken":{"type":"string","description":"결과 페이지 접근용 JWT 토큰"}}},"remainingTime":{"type":"number"},"isFreeHongsi":{"type":"boolean"},"message":{"type":"string"}}}}}},"400":{"description":"잘못된 요청 (필수 필드 누락 등)"},"401":{"description":"인증 필요"}}}},"/api/v1/fortune/chat":{"post":{"operationId":"sendChatMessage","summary":"채팅형 운세 메시지 전송","description":"활성 세션에서 AI 운세 상담 메시지를 전송하고 응답을 받습니다.","tags":["Fortune"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["sessionId","message"],"properties":{"sessionId":{"type":"string","description":"세션 ID","example":"session_clx1234567890"},"message":{"type":"string","description":"사용자 메시지","example":"연애운이 어떤가요?"}}}}}},"responses":{"200":{"description":"응답 생성 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"summary":{"type":"string","description":"핵심 요약"},"points":{"type":"array","items":{"type":"string"},"description":"운세/조언 포인트"},"tips":{"type":"array","items":{"type":"string"},"description":"실천 팁"},"disclaimer":{"type":"string","description":"면책 문구"},"suggestPayment":{"type":"boolean","description":"결제 연장 제안 여부"}}},"remainingTime":{"type":"number","description":"남은 시간 (초)"},"message":{"type":"string"}}}}}},"400":{"description":"세션 없음 또는 시간 부족"},"401":{"description":"인증 필요"}}}},"/api/v1/fortune/document":{"post":{"operationId":"createDocumentReport","summary":"문서형 운세 리포트 생성","description":"결제 완료된 문서형 세션에서 운세 리포트를 생성합니다. (결제 필수)","tags":["Fortune"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["category","formType","userInput"],"properties":{"category":{"type":"string","enum":["SAJU","NEW_YEAR","MONEY","HAND","TOJEONG","BREAK_UP","CAR_PURCHASE","BUSINESS","INVESTMENT","LOVE","DREAM","LUCKY_NUMBER","MOVING","TRAVEL","COMPATIBILITY","TAROT","CAREER","LUCKY_DAY","NAMING","DAILY"],"description":"운세 카테고리","example":"SAJU"},"formType":{"type":"string","enum":["ASK","DAILY","TRADITIONAL"],"description":"폼 타입 (ASK=자유질문, DAILY=오늘의 운세, TRADITIONAL=전통 운세)","example":"TRADITIONAL"},"userInput":{"type":"string","description":"사용자 정보 또는 질문","example":"1990년 1월 1일 오전 10시에 태어났어요"}}}}}},"responses":{"201":{"description":"리포트 생성 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"title":{"type":"string"},"date":{"type":"string"},"summary":{"type":"string"},"content":{"type":"string"},"advice":{"type":"array","items":{"type":"string"}},"warnings":{"type":"array","items":{"type":"string"}},"chatPrompt":{"type":"string"},"documentLink":{"type":"string","description":"생성된 문서 리포트의 직접 링크"},"resultToken":{"type":"string","description":"결과 페이지 접근용 JWT 토큰"}}},"message":{"type":"string"}}}}}},"400":{"description":"결제 필요 또는 잘못된 요청"},"401":{"description":"인증 필요"}}}},"/api/v1/fortune/session/{id}":{"get":{"operationId":"getFortuneSession","summary":"운세 세션 조회","description":"특정 운세 세션의 정보를 조회합니다.","tags":["Fortune"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"세션 ID"}],"responses":{"200":{"description":"세션 조회 성공"},"401":{"description":"인증 필요"},"404":{"description":"세션을 찾을 수 없음"}}}},"/api/v1/fortune/document/{id}":{"get":{"operationId":"getDocumentReport","summary":"문서 리포트 조회","description":"생성된 문서형 운세 리포트를 조회합니다.","tags":["Fortune"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"문서 ID"}],"responses":{"200":{"description":"문서 조회 성공"},"401":{"description":"인증 필요"},"404":{"description":"문서를 찾을 수 없음"}}}},"/api/v1/fortune/payment/webhook":{"post":{"operationId":"fortunePaymentWebhook","summary":"결제 웹훅 (PortOne 서버→서버)","description":"결제 완료 알림을 수신하고 결제 내역을 확정합니다.","tags":["Fortune"],"security":[],"parameters":[{"in":"header","name":"x-webhook-secret","required":true,"schema":{"type":"string"},"description":"PortOne 웹훅 시크릿 (백엔드 환경변수와 일치해야 함)"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["orderId","paymentId","amount","status"],"properties":{"orderId":{"type":"string","description":"주문 ID","example":"order_1234567890"},"paymentId":{"type":"string","description":"결제 ID","example":"payment_1234567890"},"amount":{"type":"number","description":"결제 금액","example":10000},"status":{"type":"string","enum":["PAID","FAILED","PENDING","CANCELLED","USER_CANCELLED","REFUNDED"],"description":"결제 상태","example":"PAID"}}}}}},"responses":{"200":{"description":"웹훅 처리 성공"},"400":{"description":"잘못된 요청 (필수 파라미터 누락)"},"403":{"description":"웹훅 시크릿 불일치"},"500":{"description":"웹훅 처리 실패"}}}},"/api/v1/fortune/result/{token}":{"get":{"operationId":"getFortuneResultByToken","summary":"운세 결과 조회 (토큰 기반)","description":"결과 토큰을 사용하여 운세 세션 메타데이터, 문서, 최근 채팅, CTA 정보를 조회합니다.","tags":["Fortune"],"security":[],"parameters":[{"in":"path","name":"token","required":true,"schema":{"type":"string"},"description":"결과 페이지 접근용 JWT 토큰"}],"responses":{"200":{"description":"운세 결과 조회 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"sessionMeta":{"type":"object","properties":{"sessionId":{"type":"string"},"category":{"type":"string"},"formType":{"type":"string"},"mode":{"type":"string"},"remainingTime":{"type":"number"},"isPaid":{"type":"boolean"},"expiresAt":{"type":"string","format":"date-time"}}},"document":{"type":"object","nullable":true,"properties":{"id":{"type":"string"},"userId":{"type":"string"},"category":{"type":"string"},"title":{"type":"string"},"content":{"type":"string"},"issuedAt":{"type":"string","format":"date-time"},"expiresAt":{"type":"string","format":"date-time"},"documentLink":{"type":"string","nullable":true}}},"lastChats":{"type":"array","items":{"type":"object"},"description":"최근 5개 채팅 기록 (채팅형 세션일 경우)"},"cta":{"type":"object","properties":{"label":{"type":"string"},"requiresPayment":{"type":"boolean"}}}}}},"message":{"type":"string"}}}}},"401":{"description":"토큰 유효성 검증 실패 (TOKEN_INVALID)"},"404":{"description":"세션을 찾을 수 없음 (SESSION_EXPIRED)"},"500":{"description":"서버 오류"}}}},"/api/v1/fortune/hongsi/purchase":{"post":{"operationId":"purchaseHongsi","summary":"홍시 구매","description":"시간 단위 홍시를 구매합니다. (5분/10분/30분)","tags":["Fortune"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["unit"],"properties":{"unit":{"type":"string","enum":["MINUTES_5","MINUTES_10","MINUTES_30"],"description":"홍시 단위","example":"MINUTES_10"},"sessionId":{"type":"string","description":"활성 세션 ID (선택, 있으면 자동 연장)"}}}}}},"responses":{"200":{"description":"홍시 구매 성공"},"401":{"description":"인증 필요"}}}},"/api/v1/fortune/sessions/{id}/extend":{"post":{"operationId":"extendSessionTime","summary":"세션 시간 연장","description":"활성 세션의 시간을 수동으로 연장합니다.","tags":["Fortune"],"security":[{"bearerAuth":[]}],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"세션 ID"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["additionalSeconds"],"properties":{"additionalSeconds":{"type":"number","description":"추가할 시간 (초)","example":300}}}}}},"responses":{"200":{"description":"시간 연장 성공"},"401":{"description":"인증 필요"}}}},"/api/v1/fortune/statistics":{"get":{"operationId":"getFortuneStatistics","summary":"운세 통계 조회","description":"사용자의 운세 서비스 사용 통계를 조회합니다.","tags":["Fortune"],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"통계 조회 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"totalSessions":{"type":"number"},"activeSessions":{"type":"number"},"totalDocuments":{"type":"number"},"totalChats":{"type":"number"},"categoryUsage":{"type":"object"},"popularCategories":{"type":"array"}}}}}}}},"401":{"description":"인증 필요"}}}},"/api/v1/fortune/payment/prepare":{"post":{"operationId":"prepareFortunePayment","summary":"운세 결제 준비","description":"운세 상품 결제를 위한 주문을 생성하고 결제 정보를 반환합니다.","tags":["Fortune"],"security":[{"bearerAuth":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["productType","category"],"properties":{"productType":{"type":"string","enum":["CHAT_SESSION","DOCUMENT_REPORT"],"description":"상품 타입","example":"CHAT_SESSION"},"category":{"type":"string","enum":["SAJU","NEW_YEAR","MONEY","HAND","TOJEONG","BREAK_UP","CAR_PURCHASE","BUSINESS","INVESTMENT","LOVE","DREAM","LUCKY_NUMBER","MOVING","TRAVEL","COMPATIBILITY","TAROT","CAREER","LUCKY_DAY","NAMING","DAILY"],"description":"운세 카테고리","example":"SAJU"},"durationMinutes":{"type":"number","enum":[5,10,30],"description":"채팅형일 경우 시간 선택 (5, 10, 30분, 필수)","example":10}}}}}},"responses":{"200":{"description":"결제 준비 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","properties":{"orderId":{"type":"string"},"paymentId":{"type":"string"},"amount":{"type":"number","description":"실제 결제 금액 (할인 적용 후)"},"productName":{"type":"string"},"merchantUid":{"type":"string","description":"PortOne 결제 창 오픈에 사용할 주문 고유 ID"}}},"message":{"type":"string"}}}}}},"400":{"description":"잘못된 요청"},"401":{"description":"인증 필요"}}}},"/api/v1/fortune/products":{"get":{"operationId":"getAllProducts","summary":"전체 상품 정보 조회","description":"모든 카테고리의 상품 정보를 조회합니다. (인증 불필요)","tags":["Fortune"],"responses":{"200":{"description":"전체 상품 정보 조회 성공","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"data":{"type":"object","additionalProperties":{"type":"array","items":{"type":"object"}}}}}}}}}}}}}