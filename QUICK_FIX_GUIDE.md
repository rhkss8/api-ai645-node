# 빠른 수정 가이드: users.phone 컬럼 누락 문제

## 🚨 문제
소셜 로그인 및 이메일 로그인 시 `users.phone` 컬럼이 없다는 오류 발생

## ✅ 해결 방법 (2가지)

### 방법 1: 터미널에서 수동 마이그레이션 (빠름, 권장) ⚡

**재배포 없이 바로 해결 가능합니다!**

**⚠️ 중요: Node 서버(`api-ai645-node`) 터미널에서 실행하세요!**

1. **CloudType 대시보드 접속**
   - https://cloudtype.io 접속
   - 프로젝트: `api-ai645-node`

2. **Node 서버 터미널 접속**
   - **api-ai645-node** 카드 클릭
   - 터미널 아이콘 (□ 안에 `>_`) 클릭
   - ⚠️ PostgreSQL 카드가 아닌 **Node 서버 카드**에서 실행!

3. **다음 명령어 실행**

   **⚠️ 권한 오류가 발생하면 `generate` 단계를 건너뛰고 바로 `db push`를 실행하세요!**
   
   ```bash
   # 1. DATABASE_URL 확인 (중요!)
   echo $DATABASE_URL
   
   # 2. 데이터베이스 스키마 동기화 (핵심!)
   # ⚠️ 이 명령은 자동으로 Prisma 클라이언트도 재생성합니다!
   # ⚠️ DATABASE_URL을 통해 PostgreSQL에 자동 연결됩니다
   npx prisma db push --accept-data-loss=false
   ```
   
   **참고:** `prisma db push`는 자동으로 `generate`도 실행하므로 별도로 실행할 필요 없습니다!

3. **완료!** 
   - 서버 재시작 없이 바로 적용됩니다
   - 소셜 로그인을 다시 시도해보세요

**소요 시간: 약 1-2분**

---

### 방법 2: 재배포 (안전함, 시간 소요) 🔄

**전체 재배포를 통해 자동으로 마이그레이션 실행**

1. **CloudType 대시보드 접속**
   - 프로젝트: `api-ai645-node`
   - **Deploy** 또는 **Restart** 버튼 클릭

2. **배포 로그 확인**
   - 다음 메시지가 나타나는지 확인:
   ```
   ✅ 데이터베이스 스키마 동기화 성공
   ```

3. **완료!**
   - 배포가 완료되면 자동으로 마이그레이션 적용됨

**소요 시간: 약 5-10분 (빌드 시간 포함)**

---

## 🤔 어떤 방법을 선택해야 할까?

### 방법 1 (터미널)을 선택하는 경우:
- ✅ 빠르게 해결하고 싶을 때
- ✅ 서비스 중단 없이 수정하고 싶을 때
- ✅ 배포 로그를 확인할 필요가 없을 때

### 방법 2 (재배포)를 선택하는 경우:
- ✅ 전체 시스템을 새로 빌드하고 싶을 때
- ✅ 배포 프로세스를 확인하고 싶을 때
- ✅ 최신 코드로 완전히 새로 시작하고 싶을 때

---

## 📋 확인 방법

마이그레이션 후 다음 명령어로 확인:

```bash
# users 테이블에 phone 컬럼이 있는지 확인
npx prisma db execute --stdin <<< "SELECT column_name FROM information_schema.columns WHERE table_name = 'users' AND column_name = 'phone';"
```

결과가 나오면 성공입니다!

---

## ⚠️ 주의사항

- 방법 1을 선택해도 문제없습니다. 재배포는 선택사항입니다.
- 두 방법 모두 동일한 결과를 가져옵니다.
- 방법 1이 더 빠르고 간단합니다.

